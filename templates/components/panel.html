{% macro render(type='article', header=None, tabs=None, filters=None, pagination=None, classes=[], content_classes=[]) %}
<article class="panel {{ classes|join(' ') }}">
    
    {# 1. HEADER REGION #}
    {% if header or tabs %}
    <header>
        {% if header %}
            <h1>{{ header.title }}</h1>
            
            {% if header.subtitle %}
                <p class="subtitle">{{ header.subtitle }}</p>
            {% endif %}

            {# Meta Data - Only for Article type #}
            {% if type == 'article' and (header.author or header.date) %}
            <dl class="meta">
                {% if header.author %}
                    <dt>By</dt><dd>{{ header.author }}</dd>
                {% endif %}
                {% if header.date %}
                    <dt>Posted</dt><dd><time>{{ header.date }}</time></dd>
                {% endif %}
            </dl>
            {% endif %}
        {% endif %}

        {# Navigation Tabs - Render if data exists #}
        {% if tabs %}
        <nav aria-label="Panel Navigation">
            <ul>
                {% for tab in tabs %}
                <li>
                    <a href="{{ tab.href }}" 
                       class="{{ 'current' if tab.active else '' }}"
                       {% if tab.active %}aria-current="page"{% endif %}>
                        {{ tab.label }}
                    </a>
                </li>
                {% endfor %}
            </ul>
        </nav>
        {% endif %}
    </header>
    {% endif %}

    {# 2. TOOLBAR REGION (Grid Filters) #}
    {% if type == 'grid' and filters %}
    <div class="toolbar">
        <div class="filters">
            <span class="label">Filter:</span>
            {% for filter in filters %}
            <a href="{{ filter.href }}" class="btn {{ 'inverted' if filter.active else '' }}" style="font-size: var(--font-size-xs); padding: 2px 6px;">
                {{ filter.label }}
            </a>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    {# 3. CONTENT REGION #}
    {# Auto-apply grid layout if type is grid. Only render if caller is provided. #}
    {% if caller %}
    <section class="content {{ 'grid-layout' if type == 'grid' else '' }} {{ content_classes|join(' ') }}">
        {{ caller() }}
    </section>
    {% endif %}

    {# 4. FOOTER REGION #}
    {% if pagination or (header and header.footer) %}
    <footer>
        {% if pagination %}
        <nav class="pagination" aria-label="Pagination">
            <a href="{{ pagination.prev_href }}" class="btn {{ 'disabled' if not pagination.has_prev else '' }}" {% if not pagination.has_prev %}aria-disabled="true"{% endif %}>&larr; Prev</a>
            <span class="status">Page {{ pagination.page }} of {{ pagination.pages }}</span>
            <a href="{{ pagination.next_href }}" class="btn {{ 'disabled' if not pagination.has_next else '' }}" {% if not pagination.has_next %}aria-disabled="true"{% endif %}>Next &rarr;</a>
        </nav>
        {% elif header and header.footer %}
            {{ header.footer }}
        {% endif %}
    </footer>
    {% endif %}

</article>
{% endmacro %}